<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MAAR AI</title>
<style>
* { box-sizing: border-box; font-family: Arial, sans-serif; }
body { margin:0; background:black; color:white; overflow:hidden; }
.background { position:fixed; inset:0; background:radial-gradient(circle at center, #1a1a1a, black);
animation: silk 20s linear infinite; z-index:-1; }
@keyframes silk {0%{filter:hue-rotate(0deg);}100%{filter:hue-rotate(360deg);}}

.nav { display:flex; gap:10px; padding:10px; }
.nav button { background:#111; color:white; border:1px solid #333; padding:8px 16px; cursor:pointer; }

.section { display:none; padding:20px; }
.section.active { display:block; }

#chat-box { height:60vh; overflow-y:auto; border:1px solid #333; padding:10px; margin-bottom:10px; }
.msg { margin-bottom:10px; }
.user { color:#6cf; }
.ai { color:#6f6; }

.input-area { display:flex; gap:10px; }
input { flex:1; padding:10px; }
button { padding:10px; cursor:pointer; position:relative; }

.title.split-text span { display:inline-block; transition: transform 0.3s ease, color 0.3s ease; }
.title.split-text span:hover { transform: translateY(-10px) rotate(-10deg); color:#6cf; }

#send-btn:active::after {
  content:""; position:absolute; width:10px; height:10px; background:yellow;
  border-radius:50%; animation:spark 0.5s linear forwards;
}
@keyframes spark { 0%{transform:scale(1);}100%{transform:scale(5);opacity:0;} }
</style>
</head>
<body>

<div class="background"></div>

<nav class="nav">
  <button onclick="showSection('chat')">Chat</button>
  <button onclick="showSection('about')">About</button>
</nav>

<section id="chat" class="section active">
  <h1 class="title split-text">MAAR AI</h1>
  <div id="chat-box"></div>
  <div class="input-area">
    <input id="user-input" placeholder="Type your message..." />
    <button id="send-btn">Send</button>
  </div>
</section>

<section id="about" class="section">
  <h2>About MAAR AI</h2>
  <p>MAAR AI is a single-user intelligent assistant built with OpenAI.</p>
</section>

<script>
const chatBox = document.getElementById("chat-box");
const input = document.getElementById("user-input");
const sendBtn = document.getElementById("send-btn");

sendBtn.onclick = sendMessage;
input.addEventListener("keydown", e => { if(e.key==="Enter") sendMessage(); });

// Split text animation
document.querySelectorAll('.split-text').forEach(el=>{
  el.innerHTML = el.textContent.split('').map(c=>`<span>${c}</span>`).join('');
});

function addMessage(text,className){
  const div=document.createElement("div");
  div.className=`msg ${className}`;
  div.textContent=text;
  chatBox.appendChild(div);
  chatBox.scrollTop=chatBox.scrollHeight;
}

async function sendMessage(){
  const text=input.value.trim();
  if(!text) return;

  addMessage("You: "+text,"user");
  input.value="";

  const thinking = document.createElement("div");
  thinking.className="msg ai";
  thinking.textContent="MAAR AI is thinking...";
  chatBox.appendChild(thinking);

  try {
    // FRONTEND CALLS BACKEND AT PORT 3000
    const res = await fetch("http://localhost:3000/chat",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({message:text})
    });
    const data = await res.json();
    thinking.remove();
    addMessage(data.reply?"MAAR AI: "+data.reply:"Error: No reply","ai");
  } catch(err){
    thinking.remove();
    addMessage("Server not reachable","ai");
  }
}

function showSection(id){
  document.querySelectorAll(".section").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}
</script>

</body>
</html>
